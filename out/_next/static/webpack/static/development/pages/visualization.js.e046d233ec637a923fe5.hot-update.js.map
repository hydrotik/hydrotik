{"version":3,"file":"static/webpack/static/development/pages/visualization.js.e046d233ec637a923fe5.hot-update.js","sources":["webpack:///./src/pages/visualization.tsx"],"sourcesContent":["import React from 'react';\nimport fetch from 'node-fetch';\nimport Papa from 'papaparse';\nimport moment from 'moment';\nimport { NextPage } from 'next';\nimport { Controller, Scene } from 'react-scrollmagic';\nimport { merge, random, range } from \"lodash\";\n\nimport Layout from \"../components/global/layout\";\nimport ProgressiveImage from \"../components/ui/ProgressiveImage\";\nimport Chart from \"../components/ui/Chart\";\nimport Button from \"../components/ui/Button\";\n\nimport DataHelper from \"../utils/DataHelper\";\n\n\nconst colorDark:string = '';\nconst colorMed:string = '';\nconst colorLight:string = '';\n\ntype MyProps = {\n\tdc: DataHelper;\n};\n\ntype CovidProps = {\n  \n};\n\ntype MyState = {\n\tgithub: string;\n\tcovid: CovidProps[];\n\ttotals: Array<object>;\n\tstateData: Array<object>;\n\tapiData: Array<string>;\n};\n\nfunction numberWithCommas(x:string) {\n\treturn x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n\nfunction NumberValue(props:any) {\n\tconst v = props.value;\n\tif (isNaN(v)) {\n\t\treturn v;\n\t}\n\treturn numberWithCommas(v);\n}\n\nconst dc = new DataHelper()\n\n\n\nfunction PDFItem(props:any) {\n\tif(props.children.includes('-')){\n\t\treturn (\n\t\t\t<div key={props.index}>{props.children.replace('-', '\\u2022')}</div>\n\t\t);\n\t}else{\n\t\treturn (\n\t\t\t<div key={props.index} className=\"mt-4 -mb-4\"><strong>{props.children}</strong></div>\n\t\t);\n\t}\n}\n\nclass Visualization extends React.Component<MyProps, MyState>{\n\n\n    constructor(props:MyProps) {\n        super(props);\n\n        this.state = {\n            github: 'Loading data...',\n            covid: [],\n            totals:[[]],\n            stateData:[],\n            apiData:['Loading data...']\n        };\n\n        this.resolveCsvData = this.resolveCsvData.bind(this);\n        this.resolveStateData = this.resolveStateData.bind(this);\n        this.resolveGithubData = this.resolveGithubData.bind(this);\n        this.parseGithubData = this.parseGithubData.bind(this);\n        this.parseAPIData = this.parseAPIData.bind(this);\n    }\n\n    componentDidMount() {\n        const rdcb = this.resolveStateData;\n\n        dc.getData(\n        \t'https://raw.githubusercontent.com/chazeon/NYState-COVID-19-Tracker/master/data/NYC-covid-19-daily-data-summary.csv', \n        \tfunction(data:any){\n\t\t        Papa.parse(data, {\n\t\t\t        header: false,\n\t\t\t        complete: rdcb,\n\t\t\t        dynamicTyping: true\n\t\t\t    })\n\t\t    }\n\t    )\n\n\t    const cvcb = this.resolveCsvData;\n\n\t    dc.getData(\n        \t'https://raw.githubusercontent.com/nychealth/coronavirus-data/master/summary.csv', \n        \tfunction(data:any){\n\t\t        Papa.parse(data, {\n\t\t\t        header: false,\n\t\t\t        complete: cvcb,\n\t\t\t        dynamicTyping: true\n\t\t\t    })\n\t\t    }\n\t    )\n\n\t    const cghcb = this.resolveGithubData;\n\t    const ParseGithub = this.parseGithubData;\n\n\t    dc.getData(\n        \t'https://api.github.com/repos/nychealth/coronavirus-data/commits', \n        \tfunction(data:any){\n\t\t        ParseGithub(data, {\n\t\t\t        complete: cghcb\n\t\t\t    })\n\t\t    }\n\t    )\n\n\t    if(!process.env.IS_GITHUBPAGES){\n\t\t    const apicb = this.resolveAPIData;\n\t\t    const ParseAPI = this.parseAPIData;\n\n\t\t    dc.getData(\n\t        \t'/api/covid', \n\t        \tfunction(data:any){\n\t\t\t        ParseAPI(data, {\n\t\t\t\t        complete: apicb\n\t\t\t\t    })\n\t\t\t    }\n\t\t    )\n\t\t}\n    }\n\n    resolveCsvData(result:any) {\n        this.setState({totals: result.data});\n    }\n\n    resolveStateData(result:any) {\n    \tthis.setState({stateData: result.data});\n    }\n\n    resolveGithubData(result:any) {\n        this.setState({ github: result })\n    }\n\n    parseGithubData(result:any, config:any) {\n    \tconst r = JSON.parse(result)[0];\n    \tconst d = r.commit.author.date;\n\t    const n = moment(d).format('MM/DD/YYYY, hh:hh a');\n\t    const s = `Chart updated on ${n}`;\n\t    config.complete.apply(this, [s]);\n    }\n\n\n    \n    resolveAPIData(result:any) {\n        this.setState({ apiData: result.data })\n    }\n\n    parseAPIData(result:any, config:any) {\n\t    config.complete.apply(this, [JSON.parse(result)]);\n    }\n\n\t\n\t\n    \n    render() {\n        return (\n            <Layout>\n\t\t\t\t<main className=\"flex-1 w-full max-w-4xl p-4 mx-auto md:px-8 md:py-16\">\n\t\t\t\t\t<div className=\"bg-gray-100 mb-16\">\n\t\t\t\t\t\t<Chart />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"flex flex-col md:flex-row\">\n\t\t\t\t\t\t<div className=\"md:ml-6 md:w-2/3 mb-16\">\n\t\t\t\t\t\t\t<h2 className=\"font-bold mb-3 text-xl\">New Covid cases by day in NYC</h2>\n\t\t\t\t\t\t\t<p className=\"mb-6\">{this.state.github}</p>\n\t\t\t\t\t\t\t<h2 className=\"font-bold mb-3 text-xl\">New York City Details:</h2>\n\t\t\t\t\t\t\t<div className=\"mb-6\">\n\t\t\t\t\t\t\t\t{this.state.apiData.map((section:any, index) => (\n\t\t\t\t\t\t\t\t\t<PDFItem key={index}>{section}</PDFItem>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Button href=\"https://github.com/nychealth/coronavirus-data\">NYC Health Github</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"md:w-1/3\">\n\t\t\t\t\t\t\t<h2 className=\"font-bold mb-3 text-xl\">New York City:</h2>\n\t\t\t\t\t\t\t<div className=\"mb-6\">\n\t\t\t\t\t\t\t\t{this.state.totals.map((section:any, index) => (\n\t\t\t\t\t\t\t\t\t<div key={index}><strong>{section[0].replace('*', '')}</strong> <NumberValue value={section[1]} /></div>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/*<h2 className=\"font-bold mb-3 text-xl\">New York State:</h2>*/}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</main>\n\t\t    </Layout>\n        );\n    }\n}\n\nexport default Visualization;\t\t\t\t\t\t"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA;AACA;AAKA;AAEA;AACA;AAEA;AAGA;AACA;AACA;AACA;AAiBA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;;;;;AAGA;AAAA;AACA;AADA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AACA;AACA;AACA;AAfA;AAgBA;AACA;;;AACA;AACA;AAEA;AAGA;AACA;AACA;AACA;AAHA;AAKA;AAGA;AAEA;AAGA;AACA;AACA;AACA;AAHA;AAKA;AAGA;AACA;AAEA;AAGA;AACA;AADA;AAGA;AACA;AAEA;AACA;AACA;AAEA;AAGA;AACA;AADA;AAGA;AAEA;AACA;;;AAEA;AACA;AAAA;AAAA;AACA;;;AAEA;AACA;AAAA;AAAA;AACA;;;AAEA;AACA;AAAA;AAAA;AACA;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAIA;AACA;AAAA;AAAA;AACA;;;AAEA;AACA;AACA;;;AAKA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAUA;;;;AA5IA;AACA;AA8IA;;;;A","sourceRoot":""}