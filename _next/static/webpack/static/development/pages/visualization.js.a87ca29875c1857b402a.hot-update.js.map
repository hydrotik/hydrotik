{"version":3,"file":"static/webpack/static/development/pages/visualization.js.a87ca29875c1857b402a.hot-update.js","sources":["webpack:///./src/pages/visualization.tsx"],"sourcesContent":["import React from 'react';\nimport Papa, { ParseResult } from 'papaparse';\nimport moment from 'moment';\nimport Layout from '../components/global/layout';\nimport Chart from '../components/ui/Chart';\nimport Button from '../components/ui/Button';\nimport DataHelper from '../utils/DataHelper';\n\nconst dc = new DataHelper();\n\n/*\n*\tTypes and Interfaces\n*/\n\ntype MyProps = {\n\tdc: DataHelper;\n};\n\ntype DataProps = {\n\tdata: Array<object>;\n};\n\ntype CovidProps = {\n};\n\ninterface PDFItemProps {\n\tchildren: string;\n}\n\ntype ParseProps = {\n\tcomplete(result: string): void;\n\theader?: boolean;\n\tdynamicTyping?: boolean;\n};\n\ntype MyState = {\n\tgithub: string;\n\ttotals: Array<object>;\n\tborough: Array<string>;\n\tage: Array<string>;\n\tsex: Array<string>;\n};\n\ntype NumberProps = {\n\tvalue: number|string;\n};\n\n/*\n*\tHelper functions and sanitizers\n*/\n\nfunction numberWithCommas(x: string): string {\n\treturn x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\n}\n\nfunction NumberValue(props: NumberProps): JSX.Element {\n\tconst { value } = props;\n\treturn <span>{ typeof value === 'number' ? value : numberWithCommas(value) }</span>;\n}\n\n/*\n*\tVisualization Class\n*/\n\nclass Visualization extends React.Component<MyProps, MyState> {\n\tconstructor(props: MyProps) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tgithub: 'Loading data...',\n\t\t\ttotals: [['Loading data...', '']],\n\t\t\tborough: [],\n\t\t\tage: [],\n\t\t\tsex: [],\n\t\t};\n\n\t\tthis.resolveCsvData = this.resolveCsvData.bind(this);\n\t\tthis.resolveGithubData = this.resolveGithubData.bind(this);\n\t\tthis.parseGithubData = this.parseGithubData.bind(this);\n\t\tthis.resolveBoroughData = this.resolveBoroughData.bind(this);\n\t\tthis.resolveAgeData = this.resolveAgeData.bind(this);\n\t\tthis.resolveSexData = this.resolveSexData.bind(this);\n\t}\n\n\tcomponentDidMount(): void {\n\t\tdc.getDataPromise('https://raw.githubusercontent.com/nychealth/coronavirus-data/master/summary.csv')\n\t\t\t.then((result: object) => {\n\t\t\t\tlet data;\n\t\t\t\tPapa.parse(result.toString(), {\n\t\t\t\t\theader: true,\n\t\t\t\t\tdelimiter: ',',\n\t\t\t\t\tdynamicTyping: true,\n\t\t\t\t\tcomplete: (r) => {\n\t\t\t\t\t\tdata = r;\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\treturn data;\n\t\t\t})\n\t\t\t.then((result) => {\n\t\t\t\tconst { data } = (result as unknown) as DataProps;\n\t\t\t\tconst noAsteriks: Array<object> = JSON.parse(JSON.stringify(data).replace(/\\*/g, ''));\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.log(noAsteriks);\n\t\t\t\tthis.resolveCsvData(noAsteriks);\n\t\t\t});\n\n\t\t// dc.getData(\n\t\t// \t'https://raw.githubusercontent.com/nychealth/coronavirus-data/master/summary.csv',\n\t\t// \t(data: string): void => {\n\t\t// \t\tPapa.parse(data, {\n\t\t// \t\t\theader: false,\n\t\t// \t\t\tcomplete: cvcb,\n\t\t// \t\t\tdynamicTyping: true,\n\t\t// \t\t});\n\t\t// \t},\n\t\t// );\n\n\t\tconst cghcb = this.resolveGithubData;\n\t\tconst ParseGithub = this.parseGithubData;\n\n\t\tdc.getData(\n\t\t\t'https://api.github.com/repos/nychealth/coronavirus-data/commits',\n\t\t\t(data: string): void => {\n\t\t\t\tParseGithub(data, {\n\t\t\t\t\tcomplete: cghcb,\n\t\t\t\t});\n\t\t\t},\n\t\t);\n\n\t\tconst boroughcb = this.resolveBoroughData;\n\n\t\tdc.getData(\n\t\t\t'https://raw.githubusercontent.com/nychealth/coronavirus-data/master/boro.csv',\n\t\t\t(data: string): void => {\n\t\t\t\tPapa.parse(data, {\n\t\t\t\t\theader: false,\n\t\t\t\t\tcomplete: boroughcb,\n\t\t\t\t\tdynamicTyping: true,\n\t\t\t\t});\n\t\t\t},\n\t\t);\n\n\t\tconst agecb = this.resolveAgeData;\n\n\t\tdc.getData(\n\t\t\t'https://raw.githubusercontent.com/nychealth/coronavirus-data/master/by-age.csv',\n\t\t\t(data: string): void => {\n\t\t\t\tPapa.parse(data, {\n\t\t\t\t\theader: false,\n\t\t\t\t\tcomplete: agecb,\n\t\t\t\t\tdynamicTyping: true,\n\t\t\t\t});\n\t\t\t},\n\t\t);\n\n\t\tconst sexcb = this.resolveSexData;\n\n\t\tdc.getData(\n\t\t\t'https://raw.githubusercontent.com/nychealth/coronavirus-data/master/by-sex.csv',\n\t\t\t(data: string): void => {\n\t\t\t\tPapa.parse(data, {\n\t\t\t\t\theader: false,\n\t\t\t\t\tcomplete: sexcb,\n\t\t\t\t\tdynamicTyping: true,\n\t\t\t\t});\n\t\t\t},\n\t\t);\n\t}\n\n\tresolveCsvData(result: Array<object>): void {\n\t\tthis.setState({ totals: result });\n\t}\n\n\tresolveGithubData(result: string): void {\n\t\tthis.setState({ github: result });\n\t}\n\n\tresolveBoroughData(result: ParseResult): void {\n\t\tresult.data.shift();\n\t\tthis.setState({ borough: result.data });\n\t}\n\n\tresolveAgeData(result: ParseResult): void {\n\t\tresult.data.shift();\n\t\tthis.setState({ age: result.data });\n\t}\n\n\tresolveSexData(result: ParseResult): void {\n\t\tresult.data.shift();\n\t\tthis.setState({ sex: result.data });\n\t}\n\n\tparseGithubData(result: string, config: ParseProps): void {\n\t\tconst r = JSON.parse(result)[0];\n\t\tconst d = r.commit.author.date;\n\t\tconst n = moment(d).format('MM/DD/YYYY, hh:hh a');\n\t\tconst s = `Chart updated on ${n}`;\n\t\tconfig.complete.apply(this, [s]);\n\t}\n\n\trender(): JSX.Element {\n\t\tconst {\n\t\t\tgithub,\n\t\t\tborough,\n\t\t\tage,\n\t\t\tsex,\n\t\t\ttotals,\n\t\t} = this.state;\n\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.log(totals);\n\t\treturn (\n\t\t\t<Layout>\n\t\t\t\t<main className=\"flex-1 w-full max-w-4xl p-4 mx-auto md:px-8 md:py-16\">\n\t\t\t\t\t<h1 className=\"font-bold text-xl mb-5\">Covid Visualization</h1>\n\t\t\t\t\t<div className=\"bg-gray-100 mb-16\">\n\t\t\t\t\t\t<Chart />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"flex flex-col md:flex-row\">\n\t\t\t\t\t\t<div className=\"md:ml-6 md:w-2/3 mb-16\">\n\t\t\t\t\t\t\t<h2 className=\"font-bold mb-3 text-xl\">New Covid cases by day in NYC</h2>\n\t\t\t\t\t\t\t<p className=\"mb-6\">{ github }</p>\n\t\t\t\t\t\t\t<h2 className=\"font-bold text-xl\">Borough Totals:</h2>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t//\teslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t\t\t\t\t\tborough.map((section: any) => (\n\t\t\t\t\t\t\t\t\t<div key={section[0]}>\n\t\t\t\t\t\t\t\t\t\t<strong>{section[0]}</strong>\n\t\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t\t\t<NumberValue value={section[1]} />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t<h2 className=\"font-bold text-xl\">Case Rate By Age:</h2>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t//\teslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t\t\t\t\t\tage.map((section: any) => (\n\t\t\t\t\t\t\t\t\t<div key={section[0]}>\n\t\t\t\t\t\t\t\t\t\t<strong>{section[0]}</strong>\n\t\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t\t\t<NumberValue value={section[1]} />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t<h2 className=\"font-bold text-xl\">Case Rate By Sex:</h2>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t//\teslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t\t\t\t\t\tsex.map((section: any) => (\n\t\t\t\t\t\t\t\t\t<div key={section[0]}>\n\t\t\t\t\t\t\t\t\t\t<strong>{section[0]}</strong>\n\t\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t\t\t<NumberValue value={section[1]} />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t<Button href=\"https://github.com/nychealth/coronavirus-data\">NYC Health Github</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"md:w-1/3\">\n\t\t\t\t\t\t\t<h2 className=\"font-bold mb-3 text-xl\">New York City:</h2>\n\t\t\t\t\t\t\t<div className=\"mb-6\">\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t//\teslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t\t\t\t\t\t\ttotals.map((section: any) => (\n\t\t\t\t\t\t\t\t\t\t<div key={section[0]}>\n\t\t\t\t\t\t\t\t\t\t\t<strong>{section[0]}</strong>\n\t\t\t\t\t\t\t\t\t\t\t{' '}\n\t\t\t\t\t\t\t\t\t\t\t<NumberValue value={section[1]} />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t))\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</main>\n\t\t\t</Layout>\n\t\t);\n\t}\n}\n\nexport default Visualization;\n"],"mappings":"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","sourceRoot":""}